// Generated by CoffeeScript 1.3.3
var benchmark;

benchmark = (function() {
  var highlightExtremes, init, runTests, times;
  times = {};
  init = function(name) {
    var heading, ol;
    heading = document.createElement("h2");
    heading.innerHTML = name;
    document.body.appendChild(heading);
    ol = document.createElement("ol");
    document.body.appendChild(ol);
    return ol;
  };
  runTests = function(tests, view, iterations) {
    var label, _fn;
    _fn = function(name, test) {
      var func;
      func = function() {
        var l, li, start, total;
        start = new Date().getTime();
        l = iterations;
        if (!test.length) {
          while (l--) {
            test();
          }
        } else {
          test(l);
        }
        total = new Date().getTime() - start;
        times[name] = total;
        li = document.createElement("li");
        li.innerHTML = "" + name + ": " + total + " ms(total), " + (total / iterations) + " ms(avg)";
        view.appendChild(li);
      };
      setTimeout(func, 15);
    };
    for (label in tests) {
      if ((!tests.hasOwnProperty(label)) || typeof tests[label] !== "function") {
        continue;
      }
      _fn(label, tests[label]);
    }
  };
  highlightExtremes = function(view) {
    var func;
    func = function() {
      var fastRegexp, fastest, label, li, lis, max, min, slowRegexp, slowest, _i, _len;
      min = new Date().getTime();
      max = 0;
      for (label in times) {
        if (!times.hasOwnProperty(label)) {
          continue;
        }
        if (times[label] < min) {
          min = times[label];
          fastest = label;
        }
        if (times[label] > max) {
          max = times[label];
          slowest = label;
        }
      }
      lis = view.getElementsByTagName("li");
      fastRegexp = new RegExp("^" + fastest + ":");
      slowRegexp = new RegExp("^" + slowest + ":");
      for (_i = 0, _len = lis.length; _i < _len; _i++) {
        li = lis[_i];
        if (slowRegexp.test(li.innerHTML)) {
          li.style.color = "#c00";
        }
        if (fastRegexp.test(li.innerHTML)) {
          li.style.color = "#0c0";
        }
      }
    };
    setTimeout(func, 15);
  };
  benchmark = function(name, tests, iterations) {
    var view;
    iterations = iterations || 1000;
    times = {};
    view = init(name);
    runTests(tests, view, iterations);
    highlightExtremes(view);
  };
  return benchmark;
})();
